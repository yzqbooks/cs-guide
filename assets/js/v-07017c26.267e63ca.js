"use strict";(self.webpackChunkcs_guide=self.webpackChunkcs_guide||[]).push([[64304],{78834:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t=JSON.parse('{"key":"v-07017c26","path":"/windows-tutor/autohotkey-tutor/my-ahk.html","title":"我的一些ahk脚本","lang":"zh-CN","frontmatter":{"summary":"我的一些ahk脚本 原神自动点击剧情","head":[["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/windows-tutor/autohotkey-tutor/my-ahk.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"我的一些ahk脚本"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2022-04-29T17:54:12.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:modified_time","content":"2022-04-29T17:54:12.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"原神自动点击剧情","slug":"原神自动点击剧情","children":[]}],"git":{"createdTime":1649778835000,"updatedTime":1651254852000,"contributors":[{"name":"yzqdev","email":"yzqdev@outlook.com","commits":2}]},"readingTime":{"minutes":0.43,"words":128},"filePathRelative":"windows-tutor/autohotkey-tutor/my-ahk.md","localizedDate":"2022年4月12日"}')},47616:(n,s,a)=>{a.r(s),a.d(s,{default:()=>o});var t=a(66252);const e=[(0,t.uE)('<h1 id="我的一些ahk脚本" tabindex="-1"><a class="header-anchor" href="#我的一些ahk脚本" aria-hidden="true">#</a> 我的一些ahk脚本</h1><h2 id="原神自动点击剧情" tabindex="-1"><a class="header-anchor" href="#原神自动点击剧情" aria-hidden="true">#</a> 原神自动点击剧情</h2><div class="language-autohotkey ext-autohotkey line-numbers-mode"><pre class="language-autohotkey"><code>\n\n<span class="token function">UAC</span><span class="token punctuation">(</span><span class="token punctuation">)</span> \n\n<span class="token function">SwitchIME</span><span class="token punctuation">(</span>dwLayout<span class="token punctuation">)</span><span class="token punctuation">{</span>\n    HKL<span class="token operator">:=</span><span class="token builtin">DllCall</span><span class="token punctuation">(</span><span class="token string">&quot;LoadKeyboardLayout&quot;</span><span class="token punctuation">,</span> Str<span class="token punctuation">,</span> dwLayout<span class="token punctuation">,</span> UInt<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>\n    <span class="token command selector">ControlGetFocus</span><span class="token punctuation">,</span>ctl<span class="token punctuation">,</span>A\n    <span class="token command selector">SendMessage</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>HKL<span class="token punctuation">,</span><span class="token variable">%ctl%</span><span class="token punctuation">,</span>A\n<span class="token punctuation">}</span>\n<span class="token function">SwitchIME</span><span class="token punctuation">(</span><span class="token number">0x04090409</span><span class="token punctuation">)</span>\n<span class="token function">autoClick</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>\n\n    <span class="token command selector">Send</span> <span class="token punctuation">{</span><span class="token command selector">Click</span><span class="token punctuation">,</span><span class="token number">1492</span> <span class="token number">802</span><span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n<span class="token function">setClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token command selector">SetTimer</span><span class="token punctuation">,</span> autoClick<span class="token punctuation">,</span> <span class="token number">1000</span>\n<span class="token punctuation">}</span>\n<span class="token function">killClick</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>\n\n    <span class="token command selector">SetTimer</span><span class="token punctuation">,</span> autoClick<span class="token punctuation">,</span> <span class="token keyword">Off</span>\n\n<span class="token punctuation">}</span>\n<span class="token function">genshin_window_exist</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    genshinHwnd <span class="token operator">:=</span> <span class="token builtin">WinExist</span><span class="token punctuation">(</span><span class="token string">&quot;ahk_exe GenshinImpact.exe&quot;</span><span class="token punctuation">)</span>\n    <span class="token keyword">if</span> <span class="token keyword">not</span> genshinHwnd\n    <span class="token punctuation">{</span>\n        genshinHwnd <span class="token operator">:=</span> <span class="token builtin">WinExist</span><span class="token punctuation">(</span><span class="token string">&quot;ahk_exe YuanShen.exe&quot;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n    <span class="token command selector">return</span> genshinHwnd\n<span class="token punctuation">}</span>\n<span class="token command selector">SetTimer</span><span class="token punctuation">,</span> main<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">100</span>\n<span class="token comment">;如果窗口存在</span>\n<span class="token tag">main</span><span class="token punctuation">:</span>\n    genshin_hwnd <span class="token operator">:=</span> <span class="token function">genshin_window_exist</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>genshin_hwnd<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token command selector">SetTimer</span><span class="token punctuation">,</span> main<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">800</span>\n        <span class="token command selector">Return</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">WinExist</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> genshin_hwnd<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n\n        <span class="token command selector">SetTimer</span><span class="token punctuation">,</span> main<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">500</span>\n        <span class="token command selector">Return</span>\n    <span class="token punctuation">}</span><span class="token keyword">Else</span><span class="token punctuation">{</span>\n        genshin_id <span class="token operator">:=</span><span class="token builtin">WinActive</span><span class="token punctuation">(</span><span class="token string">&quot;ahk_exe YuanShen.exe&quot;</span><span class="token punctuation">)</span>\n        <span class="token keyword">if</span> genshin_id<span class="token punctuation">{</span>\n            <span class="token symbol">F11</span><span class="token punctuation">:</span><span class="token punctuation">:</span> <span class="token function">setClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n            <span class="token symbol">F12</span><span class="token punctuation">:</span><span class="token punctuation">:</span> <span class="token function">killClick</span><span class="token punctuation">(</span> <span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token keyword">else</span><span class="token punctuation">{</span> \n\n            <span class="token command selector">SetTimer</span><span class="token punctuation">,</span> autoClick<span class="token punctuation">,</span> <span class="token keyword">Off</span>\n\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">UAC</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        full_command_line <span class="token operator">:=</span> <span class="token builtin">DllCall</span><span class="token punctuation">(</span><span class="token string">&quot;GetCommandLine&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;str&quot;</span><span class="token punctuation">)</span>\n        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span><span class="token constant">A_IsAdmin</span> or <span class="token builtin">RegExMatch</span><span class="token punctuation">(</span>full_command_line<span class="token punctuation">,</span> <span class="token string">&quot; /restart(?!\\S)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">try</span>\n            <span class="token punctuation">{</span>\n                <span class="token keyword">if</span> <span class="token constant">A_IsCompiled</span>\n                    <span class="token command selector">Run</span> <span class="token operator">*</span><span class="token command selector">RunAs</span> <span class="token string">&quot;%A_ScriptFullPath%&quot;</span> <span class="token operator">/</span>restart\n                <span class="token keyword">else</span>\n                    <span class="token command selector">Run</span> <span class="token operator">*</span><span class="token command selector">RunAs</span> <span class="token string">&quot;%A_AhkPath%&quot;</span> <span class="token operator">/</span>restart <span class="token string">&quot;%A_ScriptFullPath%&quot;</span>\n            <span class="token punctuation">}</span>\n            <span class="token command selector">ExitApp</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',3)],p={},o=(0,a(83744).Z)(p,[["render",function(n,s){return(0,t.wg)(),(0,t.iD)("div",null,e)}]])}}]);