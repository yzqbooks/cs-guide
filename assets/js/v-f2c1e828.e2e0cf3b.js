"use strict";(self.webpackChunkcs_guide=self.webpackChunkcs_guide||[]).push([[96527],{74425:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t=JSON.parse('{"key":"v-f2c1e828","path":"/csharp-tutor/snippets/winform.html","title":"winform常用代码块","lang":"zh-CN","frontmatter":{"summary":"winform常用代码块 获取快捷方式的exe所在位置 输入框focus变色 md5加密 根据cpu获取机器码 下载文件 word转为其他文档 保存为pdf文件","head":[["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/csharp-tutor/snippets/winform.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"winform常用代码块"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2022-05-29T07:27:35.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:modified_time","content":"2022-05-29T07:27:35.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"输入框focus变色","slug":"输入框focus变色","children":[]},{"level":2,"title":"md5加密","slug":"md5加密","children":[]},{"level":2,"title":"根据cpu获取机器码","slug":"根据cpu获取机器码","children":[]},{"level":2,"title":"下载文件","slug":"下载文件","children":[]},{"level":2,"title":"word转为其他文档","slug":"word转为其他文档","children":[]},{"level":2,"title":"保存为pdf文件","slug":"保存为pdf文件","children":[]}],"git":{"createdTime":1647928670000,"updatedTime":1653809255000,"contributors":[{"name":"yzqdev","email":"yzqdev@outlook.com","commits":3}]},"readingTime":{"minutes":2.36,"words":707},"filePathRelative":"csharp-tutor/snippets/winform.md","localizedDate":"2022年3月22日"}')},89912:(n,s,a)=>{a.r(s),a.d(s,{default:()=>o});var t=a(66252);const p=[(0,t.uE)('<h1 id="winform常用代码块" tabindex="-1"><a class="header-anchor" href="#winform常用代码块" aria-hidden="true">#</a> winform常用代码块</h1><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// Restart current process Method 1</span>\nSystem<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Application<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nApplication<span class="token punctuation">.</span>Current<span class="token punctuation">.</span><span class="token function">Shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Restart current process Method 2</span>\nSystem<span class="token punctuation">.</span>Reflection<span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span><span class="token function">GetEntryAssembly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token class-name"><span class="token keyword">string</span></span> startpath <span class="token operator">=</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Directory<span class="token punctuation">.</span><span class="token function">GetCurrentDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nSystem<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>Process<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>startpath <span class="token operator">+</span> “\\\\xxx<span class="token punctuation">.</span>exe”<span class="token punctuation">)</span><span class="token punctuation">;</span>\nApplication<span class="token punctuation">.</span>Current<span class="token punctuation">.</span><span class="token function">Shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// Restart current process Method 3</span>\n<span class="token class-name">Process</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\np<span class="token punctuation">.</span>StartInfo<span class="token punctuation">.</span>FileName <span class="token operator">=</span> System<span class="token punctuation">.</span>AppDomain<span class="token punctuation">.</span>CurrentDomain<span class="token punctuation">.</span>BaseDirectory <span class="token operator">+</span> “xxx<span class="token punctuation">.</span>exe”<span class="token punctuation">;</span>\np<span class="token punctuation">.</span>StartInfo<span class="token punctuation">.</span>UseShellExecute <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\np<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nApplication<span class="token punctuation">.</span>Current<span class="token punctuation">.</span><span class="token function">Shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>获取快捷方式的exe所在位置</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code>  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">Guid</span> CLSID_WshShell <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Guid</span><span class="token punctuation">(</span><span class="token string">&quot;72C24DD5-D70A-438B-8A42-98424B88AFB8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetShortCutTarget</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> lnk<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>lnk<span class="token punctuation">)</span><span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                <span class="token class-name"><span class="token keyword">dynamic</span></span> objWshShell <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> objShortcut <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n                <span class="token keyword">try</span>\n                <span class="token punctuation">{</span>\n                    objWshShell <span class="token operator">=</span> Activator<span class="token punctuation">.</span><span class="token function">CreateInstance</span><span class="token punctuation">(</span>Type<span class="token punctuation">.</span><span class="token function">GetTypeFromCLSID</span><span class="token punctuation">(</span>CLSID_WshShell<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    objShortcut <span class="token operator">=</span> objWshShell<span class="token punctuation">.</span><span class="token function">CreateShortcut</span><span class="token punctuation">(</span>lnk<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token keyword">return</span> objShortcut<span class="token punctuation">.</span>TargetPath<span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n                <span class="token keyword">finally</span>\n                <span class="token punctuation">{</span>\n                    Marshal<span class="token punctuation">.</span><span class="token function">ReleaseComObject</span><span class="token punctuation">(</span>objShortcut<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    Marshal<span class="token punctuation">.</span><span class="token function">ReleaseComObject</span><span class="token punctuation">(</span>objWshShell<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="输入框focus变色" tabindex="-1"><a class="header-anchor" href="#输入框focus变色" aria-hidden="true">#</a> 输入框focus变色</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code>\n        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">textBox1_Enter</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token punctuation">(</span><span class="token punctuation">(</span>TextBox<span class="token punctuation">)</span>sender<span class="token punctuation">)</span><span class="token punctuation">.</span>BackColor <span class="token operator">=</span> Color<span class="token punctuation">.</span>CornflowerBlue<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">textBox1_Leave</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token punctuation">(</span><span class="token punctuation">(</span>TextBox<span class="token punctuation">)</span>sender<span class="token punctuation">)</span><span class="token punctuation">.</span>BackColor <span class="token operator">=</span> Color<span class="token punctuation">.</span>White<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">textBox1_KeyDown</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">KeyEventArgs</span> e<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>KeyValue <span class="token operator">==</span> <span class="token number">13</span><span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                <span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>TextBox<span class="token punctuation">)</span>sender<span class="token punctuation">)</span><span class="token punctuation">.</span>Tag<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token function">Clear_Control</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token preprocessor property">#<span class="token directive keyword">region</span>  遍历指定的控件</span>\n        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>\n        <span class="token doc-comment comment">/// 遍历指定的控件</span>\n        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>\n        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">Con</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ControlCollection<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>可视化控件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param</span><span class="token punctuation">&gt;</span></span></span>\n        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">n</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>控件标识<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param</span><span class="token punctuation">&gt;</span></span></span>\n        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">m</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>最大标识<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param</span><span class="token punctuation">&gt;</span></span></span>\n        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Clear_Control</span><span class="token punctuation">(</span><span class="token class-name">Control<span class="token punctuation">.</span>ControlCollection</span> Con<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> n<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> m<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token class-name"><span class="token keyword">int</span></span> tem_n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>\n            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">Control</span> C <span class="token keyword">in</span> Con<span class="token punctuation">)</span>\n            <span class="token punctuation">{</span> <span class="token comment">//遍历可视化组件中的所有控件</span>\n                <span class="token keyword">if</span> <span class="token punctuation">(</span>C<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">&quot;TextBox&quot;</span><span class="token punctuation">)</span>  <span class="token comment">//判断是否为TextBox控件</span>\n                <span class="token punctuation">{</span>\n                    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> m<span class="token punctuation">)</span>\n                        tem_n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n                    <span class="token keyword">else</span>\n                        tem_n <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>\n                    <span class="token keyword">if</span> <span class="token punctuation">(</span>Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>TextBox<span class="token punctuation">)</span>C<span class="token punctuation">)</span><span class="token punctuation">.</span>Tag<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span>tem_n<span class="token punctuation">)</span>\n                        <span class="token punctuation">(</span><span class="token punctuation">(</span>TextBox<span class="token punctuation">)</span>C<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//清空当前控件</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        <span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="md5加密" tabindex="-1"><a class="header-anchor" href="#md5加密" aria-hidden="true">#</a> md5加密</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code>  <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">textBox2_TextChanged</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            textBox3<span class="token punctuation">.</span>Text <span class="token operator">=</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>FormsAuthentication<span class="token punctuation">.</span><span class="token function">HashPasswordForStoringInConfigFile</span><span class="token punctuation">(</span>textBox2<span class="token punctuation">.</span>Text<span class="token punctuation">,</span> <span class="token string">&quot;MD5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="根据cpu获取机器码" tabindex="-1"><a class="header-anchor" href="#根据cpu获取机器码" aria-hidden="true">#</a> 根据cpu获取机器码</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code>  <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Form1_Load</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            label1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">GetDiskVolumeSerialNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获得24位Cpu和硬盘序列号</span>\n            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> strid <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//把字符赋给数组</span>\n            <span class="token punctuation">{</span>\n                strid<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> label1<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            label1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>\n            <span class="token class-name">Random</span> rdid <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//从数组随机抽取24个字符组成新的字符生成机器码</span>\n            <span class="token punctuation">{</span>\n                label1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> strid<span class="token punctuation">[</span>rdid<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        <span class="token comment">//取得设备硬盘的卷标号</span>\n        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetDiskVolumeSerialNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token class-name">ManagementClass</span> mc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ManagementClass</span><span class="token punctuation">(</span><span class="token string">&quot;Win32_NetworkAdapterConfiguration&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token class-name">ManagementObject</span> disk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ManagementObject</span><span class="token punctuation">(</span><span class="token string">&quot;win32_logicaldisk.deviceid=\\&quot;d:\\&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            disk<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">return</span> disk<span class="token punctuation">.</span><span class="token function">GetPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;VolumeSerialNumber&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token comment">//获得CPU的序列号</span>\n        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token class-name"><span class="token keyword">string</span></span> strCpu <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n            <span class="token class-name">ManagementClass</span> myCpu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ManagementClass</span><span class="token punctuation">(</span><span class="token string">&quot;win32_Processor&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token class-name">ManagementObjectCollection</span> myCpuConnection <span class="token operator">=</span> myCpu<span class="token punctuation">.</span><span class="token function">GetInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">ManagementObject</span> myObject <span class="token keyword">in</span> myCpuConnection<span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                strCpu <span class="token operator">=</span> myObject<span class="token punctuation">.</span>Properties<span class="token punctuation">[</span><span class="token string">&quot;Processorid&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token keyword">break</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">return</span> strCpu<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="下载文件" tabindex="-1"><a class="header-anchor" href="#下载文件" aria-hidden="true">#</a> 下载文件</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code> <span class="token class-name"><span class="token keyword">string</span></span> uri <span class="token operator">=</span> textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>\n            <span class="token class-name"><span class="token keyword">string</span></span> LocalFileName <span class="token operator">=</span> <span class="token string">&quot;local.gif&quot;</span><span class="token punctuation">;</span>\n            <span class="token class-name">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>WebClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>WebClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            client<span class="token punctuation">.</span><span class="token function">DownloadFile</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span>LocalFileName<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span>pictureBox1<span class="token punctuation">.</span>Image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token function">FromFile</span><span class="token punctuation">(</span>LocalFileName<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="word转为其他文档" tabindex="-1"><a class="header-anchor" href="#word转为其他文档" aria-hidden="true">#</a> word转为其他文档</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code>  <span class="token class-name">Microsoft<span class="token punctuation">.</span>Office<span class="token punctuation">.</span>Interop<span class="token punctuation">.</span>Word<span class="token punctuation">.</span>Application</span> wApp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Microsoft<span class="token punctuation">.</span>Office<span class="token punctuation">.</span>Interop<span class="token punctuation">.</span>Word<span class="token punctuation">.</span>Application</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token comment">//指定原文件和目标文件 </span>\n                <span class="token class-name"><span class="token keyword">object</span></span> docPath <span class="token operator">=</span> WordFilePath<span class="token punctuation">;</span>\n                <span class="token class-name"><span class="token keyword">string</span></span> htmlPath <span class="token operator">=</span> WordFilePath<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> WordFilePath<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;txt&quot;</span><span class="token punctuation">;</span>\n                <span class="token class-name"><span class="token keyword">object</span></span> Target <span class="token operator">=</span> htmlPath<span class="token punctuation">;</span>\n                <span class="token comment">//缺省参数 </span>\n                <span class="token class-name"><span class="token keyword">object</span></span> Unknown <span class="token operator">=</span> Type<span class="token punctuation">.</span>Missing<span class="token punctuation">;</span>\n                <span class="token comment">//只读方式打开 </span>\n                <span class="token class-name"><span class="token keyword">object</span></span> readOnly <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n                <span class="token comment">//打开doc文件 </span>\n                <span class="token class-name">Microsoft<span class="token punctuation">.</span>Office<span class="token punctuation">.</span>Interop<span class="token punctuation">.</span>Word<span class="token punctuation">.</span>Document</span> document <span class="token operator">=</span> wApp<span class="token punctuation">.</span>Documents<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token keyword">ref</span> docPath<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span>\n                <span class="token keyword">ref</span> readOnly<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span>\n                <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span>\n                <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span>\n                <span class="token keyword">ref</span> Unknown<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token comment">// 指定格式</span>\n                <span class="token class-name"><span class="token keyword">object</span></span> format <span class="token operator">=</span> Microsoft<span class="token punctuation">.</span>Office<span class="token punctuation">.</span>Interop<span class="token punctuation">.</span>Word<span class="token punctuation">.</span>WdSaveFormat<span class="token punctuation">.</span>wdFormatText<span class="token punctuation">;</span>\n                <span class="token comment">// 转换格式 </span>\n                document<span class="token punctuation">.</span><span class="token function">SaveAs</span><span class="token punctuation">(</span><span class="token keyword">ref</span> Target<span class="token punctuation">,</span> <span class="token keyword">ref</span> format<span class="token punctuation">,</span>\n                <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span>\n                <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span>\n                <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token comment">// 关闭文档和Word程序 </span>\n                document<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                wApp<span class="token punctuation">.</span><span class="token function">Quit</span><span class="token punctuation">(</span><span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">,</span> <span class="token keyword">ref</span> Unknown<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="保存为pdf文件" tabindex="-1"><a class="header-anchor" href="#保存为pdf文件" aria-hidden="true">#</a> 保存为pdf文件</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code> <span class="token comment">//该变量保存PDF的文档名</span>\n        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">string</span></span> filePath <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>\n\n        <span class="token comment">//创建PDF文档</span>\n        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button1_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token comment">//给出文件保存信息，确定保存位置</span>\n            <span class="token class-name">SaveFileDialog</span> saveFileDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SaveFileDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            saveFileDialog<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">&quot;PDF文件（*.PDF）|*.PDF&quot;</span><span class="token punctuation">;</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>saveFileDialog<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                filePath <span class="token operator">=</span> saveFileDialog<span class="token punctuation">.</span>FileName<span class="token punctuation">;</span>\n                <span class="token comment">//开始创建PDF文档</span>\n                <span class="token class-name">Document</span> document <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                PdfWriter<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Create<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                document<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token class-name">BaseFont</span> baseFont <span class="token operator">=</span> BaseFont<span class="token punctuation">.</span><span class="token function">createFont</span><span class="token punctuation">(</span><span class="token string">@&quot;c:\\windows\\fonts\\SIMSUN.TTC,1&quot;</span><span class="token punctuation">,</span> BaseFont<span class="token punctuation">.</span>IDENTITY_H<span class="token punctuation">,</span> BaseFont<span class="token punctuation">.</span>NOT_EMBEDDED<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token class-name">iTextSharp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>Font</span> font <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">iTextSharp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>Font</span><span class="token punctuation">(</span>baseFont<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                document<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Paragraph</span><span class="token punctuation">(</span>richTextBox1<span class="token punctuation">.</span>Text<span class="token punctuation">,</span> font<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                document<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;祝贺你，文档创建成功！&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;提示信息&quot;</span><span class="token punctuation">,</span> MessageBoxButtons<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxIcon<span class="token punctuation">.</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',16)],e={},o=(0,a(83744).Z)(e,[["render",function(n,s){return(0,t.wg)(),(0,t.iD)("div",null,p)}]])}}]);