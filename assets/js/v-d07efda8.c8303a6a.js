"use strict";(self.webpackChunkcs_guide=self.webpackChunkcs_guide||[]).push([[58938],{72563:(e,s,t)=>{t.r(s),t.d(s,{data:()=>i});const i=JSON.parse('{"key":"v-d07efda8","path":"/java-tutor/orm-tutor/sql/psql-linux.html","title":"linux安装postgres","lang":"zh-CN","frontmatter":{"summary":"linux安装postgres 1. 官网 2. 安装 3. 初始化账号密码 4. 配置远程访问 重启服务生效 1. 修改linux系统postgres用户的密码 PostgreSQL会创建一个默认的linux用户postgres，修改该用户密码的方法如下： 步骤一：删除用户postgres的密码 步骤二：设置用户postgres的密码 系统提示输入新的密码","head":[["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/java-tutor/orm-tutor/sql/psql-linux.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"linux安装postgres"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2022-05-26T07:13:03.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:modified_time","content":"2022-05-26T07:13:03.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"1. 官网","slug":"_1-官网","children":[]},{"level":2,"title":"2. 安装","slug":"_2-安装","children":[]},{"level":2,"title":"3. 初始化账号密码","slug":"_3-初始化账号密码","children":[]},{"level":2,"title":"4. 配置远程访问","slug":"_4-配置远程访问","children":[{"level":3,"title":"1. 修改linux系统postgres用户的密码","slug":"_1-修改linux系统postgres用户的密码","children":[]},{"level":3,"title":"2. 修改PostgreSQL数据库默认用户postgres的密码","slug":"_2-修改postgresql数据库默认用户postgres的密码","children":[]}]},{"level":2,"title":"常见错误","slug":"常见错误","children":[{"level":3,"title":"连接pg数据库报错：no pg_hba.conf entry for host","slug":"连接pg数据库报错-no-pg-hba-conf-entry-for-host","children":[]}]}],"git":{"createdTime":1653549183000,"updatedTime":1653549183000,"contributors":[{"name":"yzqdev","email":"yzqdev@outlook.com","commits":1}]},"readingTime":{"minutes":2.67,"words":801},"filePathRelative":"java-tutor/orm-tutor/sql/psql-linux.md","localizedDate":"2022年5月26日"}')},75732:(e,s,t)=>{t.r(s),t.d(s,{default:()=>n});var i=t(66252);const r=[(0,i.uE)('<h1 id="linux安装postgres" tabindex="-1"><a class="header-anchor" href="#linux安装postgres" aria-hidden="true">#</a> linux安装postgres</h1><h2 id="_1-官网" tabindex="-1"><a class="header-anchor" href="#_1-官网" aria-hidden="true">#</a> 1. 官网</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>https://www.postgresql.org/download/linux/ubuntu/\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_2-安装" tabindex="-1"><a class="header-anchor" href="#_2-安装" aria-hidden="true">#</a> 2. 安装</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo sh -c &#39;echo &quot;deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main&quot; &gt; /etc/apt/sources.list.d/pgdg.list&#39;\nwget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -\nsudo apt-get update\nsudo apt-get -y install postgresql # 默认安装最新14\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-初始化账号密码" tabindex="-1"><a class="header-anchor" href="#_3-初始化账号密码" aria-hidden="true">#</a> 3. 初始化账号密码</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo -u postgres psql\npostgres=# \\password;\nplease enter password:\nplease reenter password:\n# 若要删除该管理员的密码（非必须）\n# sudo -u postgres psql -d postgres\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-配置远程访问" tabindex="-1"><a class="header-anchor" href="#_4-配置远程访问" aria-hidden="true">#</a> 4. 配置远程访问</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo vim /etc/postgresql/14/main/postgresql.conf\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://img2020.cnblogs.com/blog/1586673/202112/1586673-20211228142507326-2131564313.png" alt="img" loading="lazy"></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo vim /etc/postgresql/14/main/pg_hba.conf\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://img2020.cnblogs.com/blog/1586673/202112/1586673-20211228142622085-560736052.png" alt="img" loading="lazy"></p><p>重启服务生效</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo systemctl restart postgresql.service\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_1-修改linux系统postgres用户的密码" tabindex="-1"><a class="header-anchor" href="#_1-修改linux系统postgres用户的密码" aria-hidden="true">#</a> 1. 修改linux系统postgres用户的密码</h3><p>PostgreSQL会创建一个默认的linux用户postgres，修改该用户密码的方法如下：</p><p>步骤一：删除用户postgres的密码</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo` `passwd` `-d postgre\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>步骤二：设置用户postgres的密码</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo` `-u postgres ``passwd\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>系统提示输入新的密码</p><p>Enter new UNIX password:</p><p>Retype new UNIX password:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>passwd``: password updated successfully\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-修改postgresql数据库默认用户postgres的密码" tabindex="-1"><a class="header-anchor" href="#_2-修改postgresql数据库默认用户postgres的密码" aria-hidden="true">#</a> 2. 修改PostgreSQL数据库默认用户postgres的密码</h3><p>PostgreSQL数据库创建一个postgres用户作为数据库的管理员，密码随机，所以需要修改密码，方式如下：</p><p>步骤一：登录PostgreSQL</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo` `-u postgres psql\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>步骤二：修改登录PostgreSQL密码</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ALTER USER postgres WITH PASSWORD ``&#39;postgres&#39;``;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>注：</strong></p><ul><li>密码postgres要用引号引起来</li><li>命令最后有分号 \\5. 测试远程访问，输入之前修改的密码即可</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>master@master:~$ psql -U postgres -h 192.168.10.248 \nPassword for user postgres: \npsql (13.5 (Ubuntu 13.5-1.pgdg18.04+1), server 14.1 (Ubuntu 14.1-1.pgdg18.04+1))\nWARNING: psql major version 13, server major version 14.\n         Some psql features might not work.\nSSL connection (protocol: TLSv1.3, cipher: TLS_AES_256_GCM_SHA384, bits: 256, compression: off)\nType &quot;help&quot; for help.\n\npostgres=# \n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\\6. 常用操作</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo systemctl restart postgresql.service\nsudo systemctl start postgresql.service\nsudo systemctl stop postgresql.service\nsudo systemctl status postgresql.service\n# or\nsudo /etc/init.d/postgresql status\nsudo /etc/init.d/postgresql start\nsudo /etc/init.d/postgresql stop\nsudo /etc/init.d/postgresql restart\n# or\nsudo service postgresql restart\nsudo service postgresql start\nsudo service postgresql stop\nsudo service postgresql status\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\\6. 卸载</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>tester@fabu:~$ sudo dpkg --get-selections | grep postgres  # 或者sudo dpkg -l | grep postgres\npostgresql                                      install\npostgresql-14                                   install\npostgresql-client-14                            install\npostgresql-client-common                        install\npostgresql-common                               install\nsudo service postgresql stop \nsudo apt-get --purge remove postgresql\\*\nsudo rm -r /etc/postgresql/\nsudo rm -r /etc/postgresql-common/\nsudo rm -r /var/lib/postgresql/\nsudo userdel -r postgres\nsudo groupdel postgres\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置密码</p><p>如何安全地修改密码：</p><p>方式1 使用psql，连接到Postgres Server：</p><p>test1=&gt; \\password Enter new password: Enter it again: test1=&gt; 我将原密码hello，修改为hellojava.123456 这种修改方式相当于向postgres server 发送了如下命令：</p><p>ALTER USER postgres PASSWORD &#39; md53175af154as54df5as4d5f45sd6af&#39;; 后面的字符串是 hellojava经过md5加密后的字符串 12345 注意：尽量不要使用postgres作为用户密码，防止被攻击。</p><p>方式2：可以直接发送sql修改：</p><p>`这种方式不仅仅限于psql了，其余客户端也能修改，如pgadmin等</p><p>ALTER USER test1 PASSWORD &#39;secret&#39; 弊端：通过sql修改，有可能会将修改语句记录在相关工具的log里。 例如：通过psql 运行该条sql，则在.psql_history文件中会有相应语句的记录 有密码泄露的风险</p><h2 id="常见错误" tabindex="-1"><a class="header-anchor" href="#常见错误" aria-hidden="true">#</a> 常见错误</h2><h3 id="连接pg数据库报错-no-pg-hba-conf-entry-for-host" tabindex="-1"><a class="header-anchor" href="#连接pg数据库报错-no-pg-hba-conf-entry-for-host" aria-hidden="true">#</a> 连接pg数据库报错：no pg_hba.conf entry for host</h3><p>解决办法： 修改pg_hba.conf，在第一行添加一行： host all all 0.0.0.0/0 md5 表示允许任何用户连接到任何数据库，用一个加密的密码</p>',48)],l={},n=(0,t(83744).Z)(l,[["render",function(e,s){return(0,i.wg)(),(0,i.iD)("div",null,r)}]])}}]);