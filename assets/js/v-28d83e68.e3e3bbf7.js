"use strict";(self.webpackChunkcs_guide=self.webpackChunkcs_guide||[]).push([[58679],{30405:(e,l,t)=>{t.r(l),t.d(l,{data:()=>i});const i=JSON.parse('{"key":"v-28d83e68","path":"/linux-tutor/server/Iptables.html","title":"Iptables 介绍","lang":"zh-CN","frontmatter":{"summary":"Iptables 介绍 前提说明 iptables 的设置在 CentOS 和 Ubuntu 下有些细节不一样，Ubuntu 这里不讲，文章底下贴的资料有部分关于 Ubuntu 的，有需要的可以自己看。一般大家会用到 iptables 都是服务器，而一般服务器大家普遍是用 CentOS） Iptables 安装 查看是否已安装：; CentOS：rpm -q","head":[["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/linux-tutor/server/Iptables.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"Iptables 介绍"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2022-07-26T16:41:58.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:modified_time","content":"2022-07-26T16:41:58.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"前提说明","slug":"前提说明","children":[]},{"level":2,"title":"Iptables 安装","slug":"iptables-安装","children":[]},{"level":2,"title":"Iptables 的配置文件","slug":"iptables-的配置文件","children":[]},{"level":2,"title":"Iptables 服务器配置文件常用参数","slug":"iptables-服务器配置文件常用参数","children":[]},{"level":2,"title":"Iptables 例子","slug":"iptables-例子","children":[]},{"level":2,"title":"Iptables 资料","slug":"iptables-资料","children":[]}],"git":{"createdTime":1653615455000,"updatedTime":1658853718000,"contributors":[{"name":"yzqdev","email":"yzqdev@outlook.com","commits":2}]},"readingTime":{"minutes":2.9,"words":871},"filePathRelative":"linux-tutor/server/Iptables.md","localizedDate":"2022年5月27日"}')},69655:(e,l,t)=>{t.r(l),t.d(l,{default:()=>r});var i=t(66252);const a=(0,i.uE)('<h1 id="iptables-介绍" tabindex="-1"><a class="header-anchor" href="#iptables-介绍" aria-hidden="true">#</a> Iptables 介绍</h1><h2 id="前提说明" tabindex="-1"><a class="header-anchor" href="#前提说明" aria-hidden="true">#</a> 前提说明</h2><p>iptables 的设置在 CentOS 和 Ubuntu 下有些细节不一样，Ubuntu 这里不讲，文章底下贴的资料有部分关于 Ubuntu 的，有需要的可以自己看。一般大家会用到 iptables 都是服务器，而一般服务器大家普遍是用 CentOS）</p><h2 id="iptables-安装" tabindex="-1"><a class="header-anchor" href="#iptables-安装" aria-hidden="true">#</a> Iptables 安装</h2><ul><li><p>查看是否已安装：</p></li><li><p>CentOS：<code>rpm -qa | grep iptables</code></p></li><li><p>安装（一般系统是集成的）：</p></li><li><p>CentOS 6：<code>yum install -y iptables</code></p></li></ul><h2 id="iptables-的配置文件" tabindex="-1"><a class="header-anchor" href="#iptables-的配置文件" aria-hidden="true">#</a> Iptables 的配置文件</h2><ul><li>路径：<code>vim /etc/sysconfig/iptables</code></li></ul><h2 id="iptables-服务器配置文件常用参数" tabindex="-1"><a class="header-anchor" href="#iptables-服务器配置文件常用参数" aria-hidden="true">#</a> Iptables 服务器配置文件常用参数</h2><ul><li>常用命令：</li><li>查看已有规则列表，并且显示编号：<code>iptables -L -n --line-numbers</code></li><li>要删除 INPUT 里序号为 8 的规则，执行：<code>iptables -D INPUT 8</code></li><li>保存配置命令：<code>service iptables save 或者 /etc/rc.d/init.d/iptables save</code></li><li>重启服务命令 ：<code>service iptables restart</code></li><li>查看服务状态： <code>service iptables status</code></li><li>设置开启默认启动： <code>chkconfig --level 345 iptables on</code></li><li>清除所有规则(慎用) <ul><li><code>iptables -F</code></li><li><code>iptables -X</code></li><li><code>iptables -Z</code></li></ul></li><li>添加规则：格式 <code>iptables [-AI 链名] [-io 网络接口] [-p 协议] [-s 来源IP/网域] [-d 目标IP/网域] -j [ACCEPT|DROP|REJECT|LOG]</code></li><li>选项与参数： <ul><li>-AI 链名：针对某的链进行规则的 &quot;插入&quot; 或 &quot;累加&quot; <ul><li>-A ：新增加一条规则，该规则增加在原本规则的最后面。例如原本已经有四条规则，使用 -A 就可以加上第五条规则！</li><li>-I ：插入一条规则。如果没有指定此规则的顺序，默认是插入变成第一条规则。例如原本有四条规则，使用 -I 则该规则变成第一条，而原本四条变成 2~5 号链 ：有 INPUT, OUTPUT, FORWARD 等，此链名称又与 -io 有关，请看底下。</li></ul></li><li>-io 网络接口：设定封包进出的接口规范 <ul><li>-i ：封包所进入的那个网络接口，例如 eth0, lo 等接口。需与 INPUT 链配合；</li><li>-o ：封包所传出的那个网络接口，需与 OUTPUT 链配合；</li></ul></li><li>-p 协定：设定此规则适用于哪种封包格式。主要的封包格式有： tcp, udp, icmp 及 all 。</li><li>-s 来源 IP/网域：设定此规则之封包的来源项目，可指定单纯的 IP 或包括网域，例如：IP：192.168.0.100，网域：192.168.0.0/24, 192.168.0.0/255.255.255.0 均可。若规范为『不许』时，则加上 ! 即可，例如：-s ! 192.168.100.0/24 表示不许 192.168.100.0/24 之封包来源。</li><li>-d 目标 IP/网域：同 -s ，只不过这里指的是目标的 IP 或网域。</li><li>-j ：后面接动作，主要的动作有接受(ACCEPT)、丢弃(DROP)、拒绝(REJECT)及记录(LOG)</li></ul></li></ul><h2 id="iptables-例子" tabindex="-1"><a class="header-anchor" href="#iptables-例子" aria-hidden="true">#</a> Iptables 例子</h2><ul><li>开放指定端口</li><li><code>iptables -I INPUT -i lo -j ACCEPT</code> #允许本地回环接口(即运行本机访问本机)</li><li><code>iptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</code> # 允许已建立的或相关连的通行</li><li><code>iptables -I OUTPUT -j ACCEPT</code> #允许所有本机向外的访问</li><li><code>iptables -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT</code> # 允许访问 22 端口</li><li><code>iptables -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT</code> #允许访问 80 端口</li><li><code>iptables -A INPUT -p tcp -m tcp --dport 8080 -j ACCEPT</code> #允许访问 8080 端口</li><li><code>iptables -A INPUT -p tcp -m tcp --dport 21 -j ACCEPT</code> #允许 FTP 服务的 21 端口</li><li><code>iptables -A INPUT -p tcp -m tcp --dport 20 -j ACCEPT</code> #允许 FTP 服务的 20 端口</li><li><code>iptables -I INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT</code> #允许 ping</li><li><code>iptables -I INPUT -j REJECT</code> #禁止其他未允许的规则访问（使用该规则前一定要保证 22 端口是开着，不然就连 SSH 都会连不上）</li><li><code>iptables -I FORWARD -j REJECT</code></li></ul><h2 id="iptables-资料" tabindex="-1"><a class="header-anchor" href="#iptables-资料" aria-hidden="true">#</a> Iptables 资料</h2>',12),p={href:"https://wsgzao.github.io/post/iptables/",target:"_blank",rel:"noopener noreferrer"},s=(0,i.Uk)("https://wsgzao.github.io/post/iptables/"),d={href:"http://www.vpser.net/security/linux-iptables.html",target:"_blank",rel:"noopener noreferrer"},o=(0,i.Uk)("http://www.vpser.net/security/linux-iptables.html"),c={},r=(0,t(83744).Z)(c,[["render",function(e,l){const t=(0,i.up)("ExternalLinkIcon");return(0,i.wg)(),(0,i.iD)("div",null,[a,(0,i._)("ul",null,[(0,i._)("li",null,[(0,i._)("a",p,[s,(0,i.Wm)(t)])]),(0,i._)("li",null,[(0,i._)("a",d,[o,(0,i.Wm)(t)])])])])}]])}}]);