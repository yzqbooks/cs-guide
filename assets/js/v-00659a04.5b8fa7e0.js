"use strict";(self.webpackChunkcs_guide=self.webpackChunkcs_guide||[]).push([[18547],{61746:(e,n,s)=>{s.r(n),s.d(n,{data:()=>a});const a=JSON.parse('{"key":"v-00659a04","path":"/windows-tutor/powershell/awesome-ps.html","title":"教程","lang":"zh-CN","frontmatter":{"summary":"教程 Powershell的库 https://www.powershellgallery.com/ 部分教程 链接 获取命令的位置 获取命令所在目录 获取系统的编码 下载文件 可以使用openfiles这个命令，和linux下的lsof差不多 不过系统默认是关闭这个功能，要使用这个功能，需要先激活。 激活命令： 然后重启电脑 然后就可以使用了，下面命令可以","head":[["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/windows-tutor/powershell/awesome-ps.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"教程"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2022-07-25T14:57:57.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:modified_time","content":"2022-07-25T14:57:57.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"Powershell的库","slug":"powershell的库","children":[]},{"level":2,"title":"获取命令的位置","slug":"获取命令的位置","children":[{"level":3,"title":"获取命令所在目录","slug":"获取命令所在目录","children":[]}]},{"level":2,"title":"获取系统的编码","slug":"获取系统的编码","children":[]},{"level":2,"title":"下载文件","slug":"下载文件","children":[]},{"level":2,"title":"执行exe或者可执行文件","slug":"执行exe或者可执行文件","children":[]},{"level":2,"title":"清屏","slug":"清屏","children":[]},{"level":2,"title":"查看版本","slug":"查看版本","children":[]},{"level":2,"title":"获取当前进程","slug":"获取当前进程","children":[{"level":3,"title":"关闭某进程","slug":"关闭某进程","children":[]},{"level":3,"title":"查看进程的命令行","slug":"查看进程的命令行","children":[]}]},{"level":2,"title":"查看端口被哪个进程占用","slug":"查看端口被哪个进程占用","children":[]},{"level":2,"title":"重命名","slug":"重命名","children":[]},{"level":2,"title":"批量重命名","slug":"批量重命名","children":[]}],"git":{"createdTime":1658761077000,"updatedTime":1658761077000,"contributors":[{"name":"yzqdev","email":"yzqdev@outlook.com","commits":1}]},"readingTime":{"minutes":1.3,"words":389},"filePathRelative":"windows-tutor/powershell/awesome-ps.md","localizedDate":"2022年7月25日"}')},88858:(e,n,s)=>{s.r(n),s.d(n,{default:()=>v});var a=s(66252);const l=(0,a._)("h1",{id:"教程",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#教程","aria-hidden":"true"},"#"),(0,a.Uk)(" 教程")],-1),i=(0,a._)("h2",{id:"powershell的库",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#powershell的库","aria-hidden":"true"},"#"),(0,a.Uk)(" Powershell的库")],-1),t={href:"https://www.powershellgallery.com/",target:"_blank",rel:"noopener noreferrer"},o=(0,a.Uk)("https://www.powershellgallery.com/"),r=(0,a._)("br",null,null,-1),p=(0,a.Uk)(" 部分教程 "),c={href:"https://www.computerperformance.co.uk/powershell/",target:"_blank",rel:"noopener noreferrer"},d=(0,a.Uk)("链接"),u=(0,a.uE)('<h2 id="获取命令的位置" tabindex="-1"><a class="header-anchor" href="#获取命令的位置" aria-hidden="true">#</a> 获取命令的位置</h2><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code> <span class="token function">Get-Command</span> <span class="token operator">-</span>Name npm\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="获取命令所在目录" tabindex="-1"><a class="header-anchor" href="#获取命令所在目录" aria-hidden="true">#</a> 获取命令所在目录</h3><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token function">start</span> <span class="token punctuation">(</span><span class="token function">Get-Item</span> <span class="token punctuation">(</span><span class="token function">Get-Command</span> <span class="token operator">-</span>Name npm<span class="token punctuation">)</span><span class="token punctuation">.</span>Source<span class="token punctuation">)</span><span class="token punctuation">.</span>Directory\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="获取系统的编码" tabindex="-1"><a class="header-anchor" href="#获取系统的编码" aria-hidden="true">#</a> 获取系统的编码</h2><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code>chcp\n活动代码页: 936 这个是gbk编码\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="下载文件" tabindex="-1"><a class="header-anchor" href="#下载文件" aria-hidden="true">#</a> 下载文件</h2><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code>\n<span class="token function">iwr</span> <span class="token string">&quot;http://p9.pstatp.com&quot;</span> <span class="token operator">-</span>Outfile a<span class="token punctuation">.</span>webp\n或者\ncurl <span class="token string">&#39;http:www.baidu.com&#39;</span> <span class="token operator">-</span>o a<span class="token punctuation">.</span>webp\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以使用openfiles这个命令，和linux下的lsof差不多 不过系统默认是关闭这个功能，要使用这个功能，需要先激活。 激活命令：</p><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code>openfiles <span class="token operator">/</span>local on\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后重启电脑 然后就可以使用了，下面命令可以查询。</p><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code>openfiles <span class="token operator">/</span>query <span class="token operator">/</span>v\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>不用了别忘记关闭它</p><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code>openfiles <span class="token operator">/</span>local off\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="执行exe或者可执行文件" tabindex="-1"><a class="header-anchor" href="#执行exe或者可执行文件" aria-hidden="true">#</a> 执行exe或者可执行文件</h2><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token punctuation">.</span>\\fileName \n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="清屏" tabindex="-1"><a class="header-anchor" href="#清屏" aria-hidden="true">#</a> 清屏</h2><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code>clear<span class="token punctuation">|</span>cls \n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="查看版本" tabindex="-1"><a class="header-anchor" href="#查看版本" aria-hidden="true">#</a> 查看版本</h2><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token variable">$host</span><span class="token punctuation">.</span>version\n<span class="token comment">#  或者</span>\n<span class="token function">Get-Host</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="获取当前进程" tabindex="-1"><a class="header-anchor" href="#获取当前进程" aria-hidden="true">#</a> 获取当前进程</h2><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token function">Get-Process</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="关闭某进程" tabindex="-1"><a class="header-anchor" href="#关闭某进程" aria-hidden="true">#</a> 关闭某进程</h3><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token variable">$process</span> =<span class="token string">&quot;*powershellw*&quot;</span>\n<span class="token comment"># 查找和powershellw相关的进程</span>\n<span class="token function">Get-CimInstance</span> Win32_Process <span class="token punctuation">|</span> Where <span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>CommandLine <span class="token operator">-like</span> <span class="token variable">$process</span> <span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">select</span> <span class="token operator">-</span>ExpandProperty CommandLine <span class="token comment"># | Measure-Object -Line</span>\n<span class="token comment"># 关闭powershellw进程</span>\n<span class="token function">Get-CimInstance</span> Win32_Process <span class="token punctuation">|</span> Where <span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>CommandLine <span class="token operator">-like</span> <span class="token variable">$process</span><span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">Remove-CimInstance</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查看进程的命令行" tabindex="-1"><a class="header-anchor" href="#查看进程的命令行" aria-hidden="true">#</a> 查看进程的命令行</h3><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token comment"># 获取powershell进程的命令行</span>\n<span class="token function">Get-CimInstance</span> Win32_Process <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">&quot;name = &#39;powershell.exe&#39;&quot;</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> CommandLine\n<span class="token comment"># 获取命令行带有zfile.jar的命令行</span>\n<span class="token function">Get-CimInstance</span> Win32_Process  <span class="token punctuation">|</span> <span class="token function">Where-Object</span> CommandLine <span class="token operator">-Match</span> <span class="token string">&#39;zfile&#39;</span><span class="token punctuation">|</span> <span class="token function">Remove-CimInstance</span>\n\n<span class="token comment"># 关闭某进程</span>\n<span class="token function">Stop-Process</span> <span class="token operator">-</span>Id 34328\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查看端口被哪个进程占用" tabindex="-1"><a class="header-anchor" href="#查看端口被哪个进程占用" aria-hidden="true">#</a> 查看端口被哪个进程占用</h2><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token function">Get-Process</span> <span class="token operator">-</span>Id <span class="token punctuation">(</span><span class="token function">Get-NetTCPConnection</span> <span class="token operator">-</span>LocalPort 5000<span class="token punctuation">)</span><span class="token punctuation">.</span>OwningProcess\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="重命名" tabindex="-1"><a class="header-anchor" href="#重命名" aria-hidden="true">#</a> 重命名</h2><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token function">Rename-Item</span> FileName <span class="token operator">-</span>NewName NewFileName\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="批量重命名" tabindex="-1"><a class="header-anchor" href="#批量重命名" aria-hidden="true">#</a> 批量重命名</h2><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token variable">$i</span> = 0\n \n<span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path D:\\pictures <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token operator">*</span><span class="token punctuation">.</span>jpg <span class="token punctuation">|</span>\n<span class="token function">ForEach-Object</span> <span class="token punctuation">{</span>\n    <span class="token variable">$extension</span> = <span class="token variable">$_</span><span class="token punctuation">.</span>Extension\n    <span class="token variable">$newName</span> = <span class="token string">&#39;pic_{0:d6}{1}&#39;</span> <span class="token operator">-</span>f <span class="token variable">$i</span><span class="token punctuation">,</span> <span class="token variable">$extension</span>\n    <span class="token variable">$i</span><span class="token operator">++</span>\n    <span class="token function">Rename-Item</span> <span class="token operator">-</span>Path <span class="token variable">$_</span><span class="token punctuation">.</span>FullName <span class="token operator">-</span>NewName <span class="token variable">$newName</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-powershell ext-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token function">type</span> &gt; <span class="token operator">%</span>~dp0\\a<span class="token punctuation">.</span>txt\n<span class="token comment"># 新建文件</span>\n<span class="token function">echo</span> a 2&gt;FileName\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',33),h={},v=(0,s(83744).Z)(h,[["render",function(e,n){const s=(0,a.up)("ExternalLinkIcon");return(0,a.wg)(),(0,a.iD)("div",null,[l,i,(0,a._)("p",null,[(0,a._)("a",t,[o,(0,a.Wm)(s)]),r,p,(0,a._)("a",c,[d,(0,a.Wm)(s)])]),u])}]])}}]);