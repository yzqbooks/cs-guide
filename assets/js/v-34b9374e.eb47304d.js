"use strict";(self.webpackChunkcs_guide=self.webpackChunkcs_guide||[]).push([[15766],{60349:(s,a,e)=>{e.r(a),e.d(a,{data:()=>n});const n=JSON.parse('{"key":"v-34b9374e","path":"/java-tutor/orm-tutor/reset-password.html","title":"mysql重置密码","lang":"zh-CN","frontmatter":{"summary":"mysql重置密码 配置source https://dev.mysql.com/downloads/ 下载mysql8的config文件,然后在ubuntu上安装 然后就安装好了 配置mysql的远程root用户访问权限 1. 命令行登录 mysql,输入用户名，密码 2.切换到 mysql库 3.查看用户表,可以看到当前host是localhost,只允","head":[["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/java-tutor/orm-tutor/reset-password.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"mysql重置密码"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2022-04-03T06:59:29.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:modified_time","content":"2022-04-03T06:59:29.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"配置source","slug":"配置source","children":[]},{"level":2,"title":"配置mysql的远程root用户访问权限","slug":"配置mysql的远程root用户访问权限","children":[]},{"level":2,"title":"修改mysql配置文件my.cnf","slug":"修改mysql配置文件my-cnf","children":[]},{"level":2,"title":"配置阿里云安全组规则","slug":"配置阿里云安全组规则","children":[]},{"level":2,"title":"mysql","slug":"mysql","children":[{"level":3,"title":"忘记密码","slug":"忘记密码","children":[]}]}],"git":{"createdTime":1648969169000,"updatedTime":1648969169000,"contributors":[{"name":"yzqdev","email":"yzqdev@outlook.com","commits":1}]},"readingTime":{"minutes":2.06,"words":619},"filePathRelative":"java-tutor/orm-tutor/reset-password.md","localizedDate":"2022年4月3日"}')},72961:(s,a,e)=>{e.r(a),e.d(a,{default:()=>u});var n=e(66252);const t=(0,n._)("h1",{id:"mysql重置密码",tabindex:"-1"},[(0,n._)("a",{class:"header-anchor",href:"#mysql重置密码","aria-hidden":"true"},"#"),(0,n.Uk)(" mysql重置密码")],-1),l=(0,n._)("h2",{id:"配置source",tabindex:"-1"},[(0,n._)("a",{class:"header-anchor",href:"#配置source","aria-hidden":"true"},"#"),(0,n.Uk)(" 配置source")],-1),o={href:"https://dev.mysql.com/downloads/",target:"_blank",rel:"noopener noreferrer"},i=(0,n.Uk)("https://dev.mysql.com/downloads/"),r=(0,n.Uk)(" 下载mysql8的config文件,然后在ubuntu上安装"),p=(0,n.uE)('<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> dpkg -i mysql_.deb\n<span class="token function">sudo</span> <span class="token function">apt</span> update \n<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> mysql-server\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后就安装好了</p><h2 id="配置mysql的远程root用户访问权限" tabindex="-1"><a class="header-anchor" href="#配置mysql的远程root用户访问权限" aria-hidden="true">#</a> 配置mysql的远程root用户访问权限</h2><ol><li>命令行登录 mysql,输入用户名，密码</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># mysql -u root -p</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2.切换到 mysql库</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>use mysql<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>3.查看用户表,可以看到当前host是localhost,只允许本地访问</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> host,user from user<span class="token punctuation">;</span>\n+-----------+------------------+\n<span class="token operator">|</span> <span class="token function">host</span>      <span class="token operator">|</span> user             <span class="token operator">|</span>\n+-----------+------------------+\n<span class="token operator">|</span> localhost <span class="token operator">|</span> root             <span class="token operator">|</span>\n+-----------+------------------+\n<span class="token number">1</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4.更新user用户表</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mysql<span class="token operator">&gt;</span> update user <span class="token builtin class-name">set</span> <span class="token variable"><span class="token variable">`</span><span class="token function">host</span><span class="token variable">`</span></span> <span class="token operator">=</span> <span class="token string">&#39;%&#39;</span>  where <span class="token variable"><span class="token variable">`</span>user<span class="token variable">`</span></span> <span class="token operator">=</span> <span class="token string">&#39;root&#39;</span>  LIMIT <span class="token number">1</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>5.分配所有访问权限,如果已分配过，该步骤可跳过</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mysql<span class="token operator">&gt;</span> GRANT ALL PRIVILEGES ON *.* TO <span class="token string">&#39;root&#39;</span>@<span class="token string">&#39;%&#39;</span> IDENTIFIED BY <span class="token string">&#39;root密码&#39;</span> WITH GRANT OPTION<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>6.强制刷新权限</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mysql<span class="token operator">&gt;</span> flush privileges<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>7.再次查看用户表,root用户的host变成%，即允许所有的ip远程访问，如果需要指定具体的ip，就写上具体的ip即可</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> host,user from user<span class="token punctuation">;</span>\n+-----------+------------------+\n<span class="token operator">|</span> Host      <span class="token operator">|</span> User             <span class="token operator">|</span>\n+-----------+------------------+\n<span class="token operator">|</span> %         <span class="token operator">|</span> root             <span class="token operator">|</span>\n+-----------+------------------+\n<span class="token number">1</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改mysql配置文件my-cnf" tabindex="-1"><a class="header-anchor" href="#修改mysql配置文件my-cnf" aria-hidden="true">#</a> 修改mysql配置文件my.cnf</h2><p>1.使用命令<code>netstat -an|grep 3306</code> 查看端口监听状态如下所示，绑定了127.0.0.1，只允许本地访问，需要修改配置文件：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># netstat -an|grep 3306</span>\ntcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span>.0.1:3306          <span class="token number">0.0</span>.0.0:*               LISTEN\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2.修改my.cnf，注释掉<code>bind-address 127.0.0.1</code>属性，修改后如下图所示</p><p><img src="https://upload-images.jianshu.io/upload_images/6597489-5e9f258ab9966494.png?imageMogr2/auto-orient/strip|imageView2/2/w/477/format/webp#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=xjPeI&amp;originHeight=71&amp;originWidth=477&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="bind" loading="lazy"></p><p>注释掉bind-address</p><p>3.重启mysql服务<code>service mysql restart</code>,再次使用命令<code>netstat -an|grep 3306</code>查看端口监听状态</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># netstat -an|grep 3306</span>\ntcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span>.0.1:55074         <span class="token number">127.0</span>.0.1:3306          TIME_WAIT  \ntcp6       <span class="token number">0</span>      <span class="token number">0</span> :::3306                 :::*                    LISTEN\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置阿里云安全组规则" tabindex="-1"><a class="header-anchor" href="#配置阿里云安全组规则" aria-hidden="true">#</a> 配置阿里云安全组规则</h2><p>登录阿里云进入控制台，依次访问<strong>网络和安全-&gt;安全组-&gt;配置规则</strong>，在入方向上开放MySQL监听端口3306即可，如下所示</p><p><img src="https://upload-images.jianshu.io/upload_images/6597489-03199ab0f8ad6c89.png?imageMogr2/auto-orient/strip|imageView2/2/w/943/format/webp#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=ggs1O&amp;originHeight=66&amp;originWidth=943&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" loading="lazy"></p><p>开放mysql的3306端口</p><p>到此，阿里云服务器的MYSQL数据库远程访问开启成功，使用客户端测试连接成功。</p><p>​</p><h2 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql" aria-hidden="true">#</a> mysql</h2><p>注意一点 <code>Java时间比数据库时间早8小时，设置 serverTimezone=Asia/Shanghai</code> ​</p><h3 id="忘记密码" tabindex="-1"><a class="header-anchor" href="#忘记密码" aria-hidden="true">#</a> 忘记密码</h3>',34),c={href:"https://dev.mysql.com/doc/refman/8.0/en/resetting-permissions.html#resetting-permissions-windows",target:"_blank",rel:"noopener noreferrer"},d=(0,n.Uk)("https://dev.mysql.com/doc/refman/8.0/en/resetting-permissions.html#resetting-permissions-windows"),m={},u=(0,e(83744).Z)(m,[["render",function(s,a){const e=(0,n.up)("ExternalLinkIcon");return(0,n.wg)(),(0,n.iD)("div",null,[t,l,(0,n._)("p",null,[(0,n._)("a",o,[i,(0,n.Wm)(e)]),r]),p,(0,n._)("p",null,[(0,n._)("a",c,[d,(0,n.Wm)(e)])])])}]])}}]);