"use strict";(self.webpackChunkcs_guide=self.webpackChunkcs_guide||[]).push([[56475],{7247:(e,r,a)=>{a.r(r),a.d(r,{data:()=>t});const t=JSON.parse('{"key":"v-6dd25ac5","path":"/linux-tutor/base/06_monitor.html","title":"性能监控","lang":"zh-CN","frontmatter":{"index":6,"summary":"性能监控 在使用操作系统的过程中，我们经常需要查看当前的性能如何，需要了解CPU、内存和硬盘的使用情况； 本节介绍的这几个工具能满足日常工作要求； 监控CPU 查看CPU使用率 : $sar -u eg: $sar -u 1 2 [/home/weber#]sar -u 1 2 Linux 2.6.35-22-generic-pae (MyVPS) 06/2","head":[["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/linux-tutor/base/06_monitor.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"性能监控"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2022-05-26T11:39:36.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:modified_time","content":"2022-05-26T11:39:36.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"监控CPU","slug":"监控cpu","children":[]},{"level":2,"title":"查询内存","slug":"查询内存","children":[]},{"level":2,"title":"查询页面交换","slug":"查询页面交换","children":[]},{"level":2,"title":"查询硬盘使用","slug":"查询硬盘使用","children":[]},{"level":2,"title":"综合应用","slug":"综合应用","children":[]},{"level":2,"title":"总结","slug":"总结","children":[]},{"level":2,"title":"附录","slug":"附录","children":[]}],"git":{"createdTime":1653565176000,"updatedTime":1653565176000,"contributors":[{"name":"yzqdev","email":"yzqdev@outlook.com","commits":1}]},"readingTime":{"minutes":2.6,"words":780},"filePathRelative":"linux-tutor/base/06_monitor.md","localizedDate":"2022年5月26日"}')},76329:(e,r,a)=>{a.r(r),a.d(r,{default:()=>i});var t=a(66252);const n=[(0,t.uE)('<h1 id="性能监控" tabindex="-1"><a class="header-anchor" href="#性能监控" aria-hidden="true">#</a> 性能监控</h1><div class="custom-container tip"><p class="custom-container-title">提示</p><p>在使用操作系统的过程中，我们经常需要查看当前的性能如何，需要了解CPU、内存和硬盘的使用情况； 本节介绍的这几个工具能满足日常工作要求；</p></div><h2 id="监控cpu" tabindex="-1"><a class="header-anchor" href="#监控cpu" aria-hidden="true">#</a> 监控CPU</h2><p>查看CPU使用率 :</p><pre><code>$sar -u\n\neg:\n$sar -u 1 2\n[/home/weber#]sar -u 1 2\nLinux 2.6.35-22-generic-pae (MyVPS)     06/28/2014  _i686_  (1 CPU)\n\n09:03:59 AM     CPU     %user     %nice   %system   %iowait    %steal     %idle\n09:04:00 AM     all      0.00      0.00      0.50      0.00      0.00     99.50\n09:04:01 AM     all      0.00      0.00      0.00      0.00      0.00    100.00\n</code></pre><p>后面的两个参数表示监控的频率，比如例子中的1和2，表示每秒采样一次，总共采样2次；</p><p>查看CPU平均负载 :</p><pre><code>$sar -q 1 2\n</code></pre><p>sar指定-q后，就能查看运行队列中的进程数、系统上的进程大小、平均负载等；</p><h2 id="查询内存" tabindex="-1"><a class="header-anchor" href="#查询内存" aria-hidden="true">#</a> 查询内存</h2><p>查看内存使用状况 sar指定-r之后，可查看内存使用状况; :</p><pre><code>$sar -r 1 2\n09:08:48 AM kbmemfree kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact\n09:08:49 AM     17888    359784     95.26     37796     73272    507004     65.42    137400    150764\n09:08:50 AM     17888    359784     95.26     37796     73272    507004     65.42    137400    150764\nAverage:        17888    359784     95.26     37796     73272    507004     65.42    137400    150764\n</code></pre><p>查看内存使用量 :</p><pre><code>$free -m\n</code></pre><h2 id="查询页面交换" tabindex="-1"><a class="header-anchor" href="#查询页面交换" aria-hidden="true">#</a> 查询页面交换</h2><p>查看页面交换发生状况 页面发生交换时，服务器的吞吐量会大幅下降；服务器状况不良时，如果怀疑因为内存不足而导致了页面交换的发生，可以使用sar -W这个命令来确认是否发生了大量的交换； :</p><pre><code>$sar -W 1 3\n</code></pre><h2 id="查询硬盘使用" tabindex="-1"><a class="header-anchor" href="#查询硬盘使用" aria-hidden="true">#</a> 查询硬盘使用</h2><p>查看磁盘空间利用情况 :</p><pre><code>$df -h\n</code></pre><p>查询当前目录下空间使用情况 :</p><pre><code>du -sh  -h是人性化显示 s是递归整个目录的大小\n</code></pre><p>查看该目录下所有文件夹的排序后的大小 :</p><pre><code>for i in `ls`; do du -sh $i; done | sort\n或者\ndu -sh `ls`\n</code></pre><h2 id="综合应用" tabindex="-1"><a class="header-anchor" href="#综合应用" aria-hidden="true">#</a> 综合应用</h2><p>当系统中sar不可用时，可以使用以下工具替代：linux下有 vmstat、Unix系统有prstat</p><p>eg： 查看cpu、内存、使用情况： vmstat n m （n 为监控频率、m为监控次数） :</p><pre><code>[/home/weber#]vmstat 1 3\nprocs -----------memory---------- ---swap-- -----io---- -system-- ----cpu----\nr  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa\n0  0  86560  42300   9752  63556    0    1     1     1    0    0  0  0 99  0\n1  0  86560  39936   9764  63544    0    0     0    52   66   95  5  0 95  0\n0  0  86560  42168   9772  63556    0    0     0    20  127  231 13  2 84  0\n</code></pre><p>使用watch 工具监控变化 当需要持续的监控应用的某个数据变化时，watch工具能满足要求； 执行watch命令后，会进入到一个界面，输出当前被监控的数据，一旦数据变化，便会高亮显示变化情况；</p><p>eg：操作redis时，监控内存变化： :</p><pre><code>$watch -d -n 1 &#39;./redis-cli info | grep memory&#39;\n(以下为watch工具中的界面内容，一旦内存变化，即实时高亮显示变化）\nEvery 1.0s: ./redis-cli info | grep memory                                                                  Mon Apr 28 16:10:36 2014\n\nused_memory:45157376\nused_memory_human:43.07M\nused_memory_rss:47628288\nused_memory_peak:49686080\nused_memory_peak_human:47.38M\n</code></pre><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><p>top / sar / free / watch</p><h2 id="附录" tabindex="-1"><a class="header-anchor" href="#附录" aria-hidden="true">#</a> 附录</h2><p>关于sar的使用详解参考：<code>sar</code>{.interpreted-text role=&quot;ref&quot;}</p>',35)],d={},i=(0,a(83744).Z)(d,[["render",function(e,r){return(0,t.wg)(),(0,t.iD)("div",null,n)}]])}}]);