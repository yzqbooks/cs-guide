"use strict";(self.webpackChunkcs_guide=self.webpackChunkcs_guide||[]).push([[49814],{91682:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e=JSON.parse('{"key":"v-60cc434e","path":"/frontend/packaging-tool/webpack5-upgrade.html","title":"webpack5教程","lang":"zh-CN","frontmatter":{"summary":"webpack5教程 热部署 webpack\'s Watch Mode ​ webpack-dev-server webpack-dev-middlewara 搭配express进行热部署,地址 webpack配置express webpack5配置 1. Error: Cannot find module \'webpack-cli/bin/config-y","head":[["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/frontend/packaging-tool/webpack5-upgrade.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"webpack5教程"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2022-07-25T14:57:57.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:modified_time","content":"2022-07-25T14:57:57.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"热部署","slug":"热部署","children":[{"level":3,"title":"webpack\'s Watch Mode","slug":"webpack-s-watch-mode","children":[]},{"level":3,"title":"webpack-dev-server","slug":"webpack-dev-server","children":[]},{"level":3,"title":"webpack-dev-middlewara","slug":"webpack-dev-middlewara","children":[]}]},{"level":2,"title":"webpack5配置","slug":"webpack5配置","children":[]}],"git":{"createdTime":1658761077000,"updatedTime":1658761077000,"contributors":[{"name":"yzqdev","email":"yzqdev@outlook.com","commits":1}]},"readingTime":{"minutes":3.85,"words":1156},"filePathRelative":"frontend/packaging-tool/webpack5-upgrade.md","localizedDate":"2022年7月25日"}')},5600:(n,s,a)=>{a.r(s),a.d(s,{default:()=>B});var e=a(66252);const p=(0,e.uE)('<h1 id="webpack5教程" tabindex="-1"><a class="header-anchor" href="#webpack5教程" aria-hidden="true">#</a> webpack5教程</h1><h2 id="热部署" tabindex="-1"><a class="header-anchor" href="#热部署" aria-hidden="true">#</a> 热部署</h2><h3 id="webpack-s-watch-mode" tabindex="-1"><a class="header-anchor" href="#webpack-s-watch-mode" aria-hidden="true">#</a> webpack&#39;s Watch Mode</h3><p>​</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token string">&quot;watch&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;webpack --watch&quot;</span>\n自动编译模块<span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span>\n唯一的缺点是，为了看到修改后的实际效果，你需要刷新浏览器。如果能够自动刷新浏览器就更好了，可以尝试使用 webpack-dev-server，恰好可以实现我们想要的功能。\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="webpack-dev-server" tabindex="-1"><a class="header-anchor" href="#webpack-dev-server" aria-hidden="true">#</a> webpack-dev-server</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string-property property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack serve --open&quot;</span><span class="token punctuation">,</span>\n\n# 配置如下\n <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;html-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> CleanWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;clean-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token literal-property property">app</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">print</span><span class="token operator">:</span> <span class="token string">&#39;./src/print.js&#39;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&#39;inline-source-map&#39;</span><span class="token punctuation">,</span>\n   <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n     <span class="token literal-property property">contentBase</span><span class="token operator">:</span> <span class="token string">&#39;./dist&#39;</span>\n   <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n      <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;Development&#39;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].bundle.js&#39;</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n现在，我们可以在命令行中运行 npm start，就会看到浏览器自动加载页面。如果现在修改和保存任意源文件，web 服务器就会自动重新加载编译后的代码。试一下\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="webpack-dev-middlewara" tabindex="-1"><a class="header-anchor" href="#webpack-dev-middlewara" aria-hidden="true">#</a> webpack-dev-middlewara</h3>',8),t=(0,e.Uk)("搭配express进行热部署,地址 "),o={href:"https://www.webpackjs.com/guides/development/#%E4%BD%BF%E7%94%A8-webpack-dev-middleware",target:"_blank",rel:"noopener noreferrer"},l=(0,e.Uk)("webpack配置express"),c=(0,e.uE)('<h2 id="webpack5配置" tabindex="-1"><a class="header-anchor" href="#webpack5配置" aria-hidden="true">#</a> webpack5配置</h2><ol><li><code>Error: Cannot find module &#39;webpack-cli/bin/config-yargs&#39;</code></li></ol><p>在<code>webpack-cli 4.x</code>中，不能过<code>webpack-dev-server</code>启动项目了，需要通过<code>webpack serve...</code>或者修改<code>webpack-cli</code>版本改为3.x</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>  <span class="token comment">// package.json</span>\n  <span class="token comment">// webpack4.x</span>\n  <span class="token property">&quot;script&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server ...&quot;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// webpack5.x</span>\n  <span class="token property">&quot;script&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack serve ...&quot;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// 降版本</span>\n  <span class="token punctuation">{</span>\n    webpack-cli@<span class="token number">3.3</span>.<span class="token number">12</span>\n  <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><code>webpack5</code>中错误出现错误<code>UnhandledPromiseRejectionWarning: TypeError: webpack.NamedModulesPlugin is not a constructor</code></li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>  <span class="token comment">// webpack.config.js</span>\n\n  <span class="token comment">// webpack4.x</span>\n  <span class="token keyword">module</span><span class="token punctuation">.</span><span class="token keyword">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n      <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">webpack<span class="token punctuation">.</span></span>NamedModulesPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// webpack5.x</span>\n  <span class="token comment">// 在webpack5.x中，webpack.NamedModulesPlugin的功能已经内置</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>babel配置导致的文件引入错误，<code>@babel/runtime</code></li></ol><p>在webpack5.x中，发现很多关于<code>@babel/runtime/helpers/esm</code>的文件引入错误，错误提示类似下面，通过锁定@babel/runtime包版本即可</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>Module not found: Error: Can<span class="token string">&#39;t resolve &#39;</span>./superPropBase<span class="token string">&#39; in &#39;</span>/Users/xxx/node_modules/@babel/runtime/helpers/esm<span class="token string">&#39;\nDid you mean &#39;</span>superPropBase.js<span class="token string">&#39;?\nBREAKING CHANGE: The request &#39;</span>./superPropBase<span class="token string">&#39; failed to resolve only because it was resolved as fully specified\n(probably because the origin is a &#39;</span>*.mjs<span class="token string">&#39; file or a &#39;</span>*.js<span class="token string">&#39; file where the package.json contains &#39;</span><span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;module&quot;</span>&#39;<span class="token punctuation">)</span>.\nThe extension <span class="token keyword">in</span> the request is mandatory <span class="token keyword">for</span> it to be fully specified.\nAdd the extension to the request\n  <span class="token function">npm</span> <span class="token function">install</span> @babel/runtime@7.12.0 -D\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><code>webpack &lt; 5 used to include polyfills for node.js core modules by default</code></li></ol><p>在运行过程中出现了很多这样的报错信息，是由于在webpack5中移除了nodejs核心模块的polyfill自动引入，所以需要手动引入，如果打包过程中有使用到nodejs核心模块，webpack会提示进行相应配置</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">// webpack.config.js</span>\n  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token operator">...</span>\n    <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token comment">// https://github.com/babel/babel/issues/8462</span>\n      <span class="token comment">// https://blog.csdn.net/qq_39807732/article/details/110089893</span>\n      <span class="token comment">// 如果确认需要node polyfill，设置resolve.fallback安装对应的依赖</span>\n      <span class="token literal-property property">fallback</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token literal-property property">crypto</span><span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;crypto-browserify&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token literal-property property">path</span><span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;path-browserify&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token literal-property property">url</span><span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;url&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token literal-property property">buffer</span><span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;buffer/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token literal-property property">util</span><span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;util/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token literal-property property">stream</span><span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;stream-browserify/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token literal-property property">vm</span><span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;vm-browserify&#39;</span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token comment">// 如果确认不需要node polyfill，设置resolve.alias设置为false</span>\n      <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token literal-property property">crypto</span><span class="token operator">:</span> <span class="token boolean">false</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果实在<code>vue-cli</code>中,需要这样</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token literal-property property">fallback</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token literal-property property">path</span><span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;path-browserify&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n  <span class="token literal-property property">transpileDependencies</span><span class="token operator">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>DeprecationWarning: Compilation.assets will be frozen in future, all modifications are deprecated. BREAKING CHANGE: No more changes should happen to Compilation.assets after sealing the Compilation. Do changes to assets earlier, e. g. in Compilation.hooks.processAssets. Mak`e sure to select an appropriate stage from Compilation.PROCESS_ASSETS_STAGE_*.</li></ol>',15),i=(0,e.Uk)("为"),r=(0,e._)("code",null,"html-webpack-plugin",-1),u=(0,e.Uk)("这个包导致的⚠️信息，"),d={href:"https://github.com/webpack/webpack/issues/11997",target:"_blank",rel:"noopener noreferrer"},k=(0,e.Uk)("github issue"),v=(0,e._)("div",{class:"language-css ext-css line-numbers-mode"},[(0,e._)("pre",{class:"language-css"},[(0,e._)("code",null,"  npm run html-webpack-plugin@next -D\n")]),(0,e._)("div",{class:"line-numbers","aria-hidden":"true"},[(0,e._)("div",{class:"line-number"})])],-1),b=(0,e._)("ol",null,[(0,e._)("li",null,"DeprecationWarning: A 'callback' argument need to be provided to the 'webpack(options, callback)' function when the 'watch' option is set. There is no way to handle the 'watch' option without a callback")],-1),m=(0,e.Uk)("官方给出的问题原因是"),g=(0,e._)("code",null,"webpack-cli",-1),w=(0,e.Uk)("这个包的版本导致的，"),h={href:"https://github.com/webpack/webpack-cli/issues/1918",target:"_blank",rel:"noopener noreferrer"},y=(0,e.Uk)("github issue"),f=(0,e.uE)('<div class="language-avrasm ext-avrasm line-numbers-mode"><pre class="language-avrasm"><code>  // 官方提供的解决方式，修改webpack-cli版本到4.2.0既可\n  npm install webpack-cli@4.2.0 --save-dev\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>',1),q=(0,e.Uk)("不过我在本地创建了一个新的项目，版本信息如下，还是存在上面的那个报错信息，demo地址"),x={href:"https://github.com/xccjk/webpack-demo1",target:"_blank",rel:"noopener noreferrer"},_=(0,e.Uk)("github issue"),j=(0,e.uE)('<div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>  <span class="token property">&quot;webpack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.10.3&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;webpack-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.2.0&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;webpack-dev-server&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.11.0&quot;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>业务插件遇到的问题，<code>webpack-merge</code>包遇到的问题</li></ol>',2),W={href:"https://blog.csdn.net/lzc2644481789/article/details/107814848",target:"_blank",rel:"noopener noreferrer"},C=(0,e.Uk)("csdn资料"),E=(0,e.uE)('<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">// 4.x版本</span>\n  <span class="token punctuation">{</span>\n    <span class="token string-property property">&quot;webpack-merge&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.2.2&quot;</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// webpack.config.js</span>\n  <span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack-merge&#39;</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> defaultConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../...&#39;</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>defaultConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token keyword">export</span> <span class="token keyword">default</span> config\n\n  <span class="token comment">// 5.x版本</span>\n  <span class="token punctuation">{</span>\n    <span class="token string-property property">&quot;webpack-merge&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.7.0&quot;</span>\n  <span class="token punctuation">}</span>\n  <span class="token keyword">const</span> webpackMerge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack-merge&#39;</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> defaultConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../...&#39;</span><span class="token punctuation">)</span>\n  <span class="token keyword">const</span> config <span class="token operator">=</span> webpackMerge<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>defaultConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token keyword">export</span> <span class="token keyword">default</span> config\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>数据流工具<code>recoil</code>好像还不支持在webpack中使用，我们项目里有使用recoil，配置了babel后，一直提示<code>You may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders</code></li></ol>',2),P=(0,e.Uk)("官方答复："),U={href:"https://github.com/facebookexperimental/Recoil/pull/467",target:"_blank",rel:"noopener noreferrer"},S=(0,e.Uk)("guthub issue"),T=(0,e._)("ol",null,[(0,e._)("li",null,[(0,e._)("code",null,"TypeError: Cannot read property 'tap' of undefined")])],-1),z=(0,e._)("code",null,"hard-source-webpack-plugin",-1),A=(0,e.Uk)("这个包在版本升级后出现错误，"),D={href:"https://github.com/mzgoddard/hard-source-webpack-plugin/issues/461",target:"_blank",rel:"noopener noreferrer"},M=(0,e.Uk)("github issue"),N=(0,e.uE)('<div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>  <span class="token comment">// webpack.config.js</span>\n  <span class="token comment">// webpack4.x</span>\n  <span class="token keyword">const</span> <span class="token class-name">HardSourceWebpackPlugin</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>&#39;hard<span class="token operator">-</span>source<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin&#39;<span class="token punctuation">)</span>\n  <span class="token keyword">module</span><span class="token punctuation">.</span><span class="token keyword">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n    piugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token keyword">new</span> <span class="token class-name">HardSourceWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        environmentHash<span class="token operator">:</span> <span class="token punctuation">{</span>\n          root<span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n          directories<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n          files<span class="token operator">:</span> <span class="token punctuation">[</span>&#39;<span class="token keyword">package</span><span class="token operator">-</span>lock<span class="token punctuation">.</span>json<span class="token char">&#39;, &#39;</span>yarn<span class="token punctuation">.</span>lock&#39;<span class="token punctuation">]</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        cachePrune<span class="token operator">:</span> <span class="token punctuation">{</span>\n          maxAge<span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>\n          sizeThreshold<span class="token operator">:</span> <span class="token number">50</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// webpack5.x</span>\n  <span class="token comment">// https://github.com/mzgoddard/hard-source-webpack-plugin/issues/461</span>\n  <span class="token keyword">const</span> <span class="token class-name">HardSourceWebpackPlugin</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>&#39;hard<span class="token operator">-</span>source<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin&#39;<span class="token punctuation">)</span>\n  <span class="token keyword">module</span><span class="token punctuation">.</span><span class="token keyword">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n    piugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token keyword">new</span> <span class="token class-name">HardSourceWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n      <span class="token keyword">new</span> <span class="token class-name">HardSourceWebpackPlugin<span class="token punctuation">.</span>ExcludeModulePlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',1),H={},B=(0,a(83744).Z)(H,[["render",function(n,s){const a=(0,e.up)("ExternalLinkIcon");return(0,e.wg)(),(0,e.iD)("div",null,[p,(0,e._)("p",null,[t,(0,e._)("a",o,[l,(0,e.Wm)(a)])]),c,(0,e._)("p",null,[i,r,u,(0,e._)("a",d,[k,(0,e.Wm)(a)])]),v,b,(0,e._)("p",null,[m,g,w,(0,e._)("a",h,[y,(0,e.Wm)(a)])]),f,(0,e._)("p",null,[q,(0,e._)("a",x,[_,(0,e.Wm)(a)])]),j,(0,e._)("p",null,[(0,e._)("a",W,[C,(0,e.Wm)(a)])]),E,(0,e._)("p",null,[P,(0,e._)("a",U,[S,(0,e.Wm)(a)])]),T,(0,e._)("p",null,[z,A,(0,e._)("a",D,[M,(0,e.Wm)(a)])]),N])}]])}}]);